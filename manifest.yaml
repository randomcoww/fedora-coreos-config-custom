ref: fedora/${releasever}/${basearch}/silverblue
include:
  - manifests/ignition-and-ostree.yaml
  # - workstation-ostree-config/fedora-common-ostree-pkgs.yaml

releasever: "32"

rojig:
  license: MIT
  name: fedora-silverblue
  summary: "Fedora Silverblue base image"

automatic-version-prefix: "${releasever}"
mutate-os-release: "${releasever}"

repos:
  - fedora
  - fedora-modular
  - fedora-updates
  - fedora-updates-modular
  - fedora-coreos-pool
  - rpmfusion-free
  - rpmfusion-free-updates
  # - rpmfusion-nonfree
  # - rpmfusion-nonfree-updates
  - fedora-rawhide
  - code

initramfs-args:
  - --no-hostonly
  # We don't support root on NFS, so we don't need it in the initramfs. It also
  # conflicts with /var mount support in ignition because NFS tries to mount stuff
  # in /var/ and then ignition can't cleanly unmount it. For example:
  # https://github.com/dracutdevs/dracut/blob/1856ae95c873a6fe855b3dccd0144f1a96b9e71c/modules.d/95nfs/nfs-start-rpc.sh#L7
  # See also discussion in https://github.com/coreos/fedora-coreos-config/pull/60
  - --omit=nfs
  # Omit these since we don't use them
  - --omit=lvm
  - --omit=multipath
  - --omit=iscsi

recommends: false

ignore-removed-users:
  - root
ignore-removed-groups:
  - root
etc-group-members:
  - sudo
  - systemd-journal
  - adm
  - libvirt
  - wheel

check-passwd:
  type: "file"
  filename: "manifests/passwd"
check-groups:
  type: "file"
  filename: "manifests/group"

default_target: graphical.target

remove-from-packages:
  # Drop NetworkManager support for ifcfg files, see also corresponding
  # overlay.d/14NetworkManager-plugins
  - [NetworkManager, /usr/lib64/NetworkManager/.*/libnm-settings-plugin-ifcfg-rh.so]

packages:
  - fedora-repos-ostree
  # System setup
  - passwd
  # Dependency of 20live dracut module
  - bsdtar
  # SSH
  - openssh-clients
  # Containers
  - podman skopeo runc systemd-container catatonit
  - fuse-overlayfs slirp4netns
  # Remote IPC for podman
  - libvarlink-util
  # Networking
  - hostname
  - iproute-tc
  # Static firewalling
  - nftables iptables-nft
  # WireGuard https://github.com/coreos/fedora-coreos-tracker/issues/362
  - wireguard-tools
  # Storage
  - cloud-utils-growpart
  - lvm2 iscsi-initiator-utils sg3_utils
  - device-mapper-multipath
  - xfsprogs e2fsprogs btrfs-progs mdadm
  - cryptsetup
  # Time sync
  - chrony
  # Allow communication between sudo and SSSD
  # for caching sudo rules by SSSD.
  # https://github.com/coreos/fedora-coreos-tracker/issues/445
  - libsss_sudo
  # Extra runtime
  - sssd shadow-utils
  # There are things that write outside of the journal still (such as the classic wtmp, etc.)
  # (auditd also writes outside the journal but it has its own log rotation.)
  # Anything package layered will also tend to expect files dropped in
  # /etc/logrotate.d to work.  Really, this is a legacy thing, but if we don't
  # have it then people's disks will slowly fill up with logs.
  - logrotate
  # Used by admins interactively
  - sudo coreutils attr less tar xz gzip bzip2
  - socat ldns-utils
  - bash-completion
  - openssl
  - vim-minimal
  - lsof
  # CoreOS Installer
  - coreos-installer coreos-installer-bootinfra
  # i18n
  - kbd
  # Parsing/Interacting with JSON data
  - jq
  # nvme-cli for managing nvme disks
  - nvme-cli
  ## Custom
  - libva-utils vulkan-tools
  - libva-intel-hybrid-driver libva-intel-driver
  - libvirt-daemon-kvm
  - libvirt-client virt-viewer
  - ipmitool
  - kubernetes-client
  - tmux xclip vim-enhanced strace
  - eog mpv
  - toolbox
  - buildah podman-compose
  - flatpak flatpak-builder
  - mkpasswd
  - git-core
  - gnupg2
  - rsync
  - librtmp
  - youtube-dl
  - gimp
  - pulseaudio-module-zeroconf
  - vscode

  ## from gnome-desktop-pkgs.yaml
  - ModemManager
  - NetworkManager-adsl
  - NetworkManager-openconnect-gnome
  - NetworkManager-openvpn-gnome
  - NetworkManager-ppp
  - NetworkManager-pptp-gnome
  - NetworkManager-ssh-gnome
  - NetworkManager-vpnc-gnome
  - NetworkManager-wwan
  - adobe-source-code-pro-fonts
  - at-spi2-atk
  - at-spi2-core
  # - chrome-gnome-shell
  - dconf
  - gdm
  - glib-networking
  - gnome-backgrounds
  - gnome-bluetooth
  - gnome-color-manager
  - gnome-control-center
  - gnome-remote-desktop
  - gnome-session-wayland-session
  - gnome-session-xsession
  - gnome-settings-daemon
  - gnome-shell
  - gnome-terminal
  - gnome-terminal-nautilus
  - gnome-themes-extra
  - gnome-user-docs
  - gvfs-afc
  - gvfs-afp
  - gvfs-archive
  - gvfs-fuse
  - gvfs-goa
  - gvfs-gphoto2
  - gvfs-mtp
  # - gvfs-smb
  - libcanberra-gtk2
  - libcanberra-gtk3
  - libproxy-mozjs
  - librsvg2
  - libsane-hpaio
  - mesa-libEGL
  - mousetweaks
  - nautilus
  - nautilus-sendto
  - orca
  - polkit
  - tracker
  - tracker-miners
  - xdg-desktop-portal
  - xdg-desktop-portal-gtk
  - xdg-user-dirs-gtk
  - yelp

  ## from fedora-common-ostree-pkgs.yaml
  - NetworkManager
  - NetworkManager-bluetooth
  - NetworkManager-config-connectivity-fedora
  - NetworkManager-wifi
  - NetworkManager-wwan
  - aajohan-comfortaa-fonts
  - abattis-cantarell-fonts
  - acl
  # - adwaita-qt4
  # - adwaita-qt5
  - alsa-plugins-pulseaudio
  - alsa-sof-firmware
  - alsa-ucm
  - alsa-utils
  - atmel-firmware
  - attr
  # - audit
  - b43-fwcutter
  - b43-openfwwf
  - basesystem
  - bash
  - bash-completion
  - bc
  # - bind-utils
  - bluez-cups
  - bridge-utils
  - btrfs-progs
  - bzip2
  - chrony
  # - cifs-utils
  - colord
  - coreutils
  - cpio
  - cryptsetup
  - cups
  - cups-filters
  - curl
  - cyrus-sasl-plain
  - dejavu-sans-fonts
  - dejavu-sans-mono-fonts
  - dejavu-serif-fonts
  - dhcp-client
  - dnsmasq
  - e2fsprogs
  - earlyoom
  - ethtool
  # - fedora-bookmarks
  # - fedora-chromium-config
  - fedora-workstation-backgrounds
  - file
  - filesystem
  - firefox
  # - firewalld
  - foomatic
  - foomatic-db-ppds
  - fpaste
  - fros-gnome
  - gamemode
  - glibc
  - glibc-all-langpacks
  - glx-utils
  - gnupg2
  - google-noto-emoji-color-fonts
  - google-noto-sans-cjk-ttc-fonts
  - google-noto-sans-gurmukhi-fonts
  - google-noto-sans-sinhala-vf-fonts
  - gstreamer1-plugins-bad-free
  - gstreamer1-plugins-good
  - gutenprint
  - gutenprint-cups
  - hostname
  - hplip
  - hunspell
  - ibus-gtk3
  - ibus-hangul
  - ibus-kkc
  - ibus-libpinyin
  - ibus-libzhuyin
  - ibus-m17n
  # - ibus-qt
  - ibus-typing-booster
  # - iproute
  # - iptables
  - iptstate
  - iputils
  - ipw2100-firmware
  - ipw2200-firmware
  - iwl100-firmware
  - iwl1000-firmware
  - iwl105-firmware
  - iwl135-firmware
  - iwl2000-firmware
  - iwl2030-firmware
  - iwl3160-firmware
  - iwl3945-firmware
  - iwl4965-firmware
  - iwl5000-firmware
  - iwl5150-firmware
  - iwl6000-firmware
  - iwl6000g2a-firmware
  - iwl6000g2b-firmware
  - iwl6050-firmware
  - iwl7260-firmware
  - jomolhari-fonts
  - julietaula-montserrat-fonts
  - kbd
  - kernel
  - kernel-modules-extra
  - khmeros-base-fonts
  - less
  - liberation-mono-fonts
  - liberation-sans-fonts
  - liberation-serif-fonts
  - libertas-usb8388-firmware
  - linux-firmware
  - logrotate
  - lohit-assamese-fonts
  - lohit-bengali-fonts
  - lohit-devanagari-fonts
  - lohit-gujarati-fonts
  - lohit-kannada-fonts
  - lohit-odia-fonts
  - lohit-tamil-fonts
  - lohit-telugu-fonts
  - lrzsz
  - lsof
  - man-db
  - man-pages
  - mdadm
  - mesa-dri-drivers
  - mesa-vulkan-drivers
  - mlocate
  - mpage
  - mtr
  # - nano
  - nfs-utils
  - nss-altfiles
  - nss-mdns
  # - ntfsprogs
  - openssh-clients
  # - openssh-server
  - paktype-naskh-basic-fonts
  - pam_afs_session
  - paps
  - paratype-pt-sans-fonts
  - passwd
  - passwdqc
  - pciutils
  - pinfo
  - plymouth
  - plymouth-system-theme
  - policycoreutils
  - policycoreutils-python-utils
  - procps-ng
  - psmisc
  - pulseaudio
  # - pulseaudio-module-x11
  - pulseaudio-utils
  # - qemu-guest-agent
  # - qt
  # - qt-settings
  # - qt-x11
  # - qt5-qtbase
  # - qt5-qtbase-gui
  # - qt5-qtdeclarative
  # - qt5-qtxmlpatterns
  - quota
  - realmd
  - rng-tools
  - rootfiles
  - rp-pppoe
  - rpm
  - rsync
  # - samba-client
  - selinux-policy-targeted
  - setup
  - shadow-utils
  - sil-abyssinica-fonts
  - sil-mingzat-fonts
  - sil-nuosu-fonts
  - sil-padauk-fonts
  - smc-meera-fonts
  - sos
  - spice-vdagent
  - sssd
  - sssd-common
  - sssd-kcm
  - stix-fonts
  - sudo
  - system-config-printer-udev
  - systemd
  - systemd-udev
  - tar
  - thai-scalable-waree-fonts
  - time
  - tree
  - unzip
  - usb_modeswitch
  - usbutils
  - util-linux
  - vconfig
  - vim-minimal
  - wget
  - which
  - wireless-tools
  - words
  # - xorg-x11-drv-amdgpu
  # - xorg-x11-drv-ati
  # - xorg-x11-drv-evdev
  # - xorg-x11-drv-fbdev
  # - xorg-x11-drv-libinput
  # - xorg-x11-drv-nouveau
  # - xorg-x11-drv-qxl
  # - xorg-x11-drv-wacom
  # - xorg-x11-server-Xorg
  # - xorg-x11-utils
  # - xorg-x11-xauth
  # - xorg-x11-xinit
  - zd1211-firmware
  - zip
  - zram

# This thing is crying out to be pulled into systemd, but that hasn't happened
# yet.  Also we may want to add to rpm-ostree something like arch negation;
# basically right now it doesn't exist on s390x.
# Anyways, it was requested by the Red Hat perf team for RHCOS, so we have it here.
# https://serverfault.com/questions/513807/is-there-still-a-use-for-irqbalance-on-modern-hardware
# https://access.redhat.com/solutions/41535
packages-x86_64:
  - irqbalance
packages-ppc64le:
  - irqbalance
packages-aarch64:
  - irqbalance

# Things we don't expect to ship on the host.  We currently
# have recommends: false so these could only come in via
# hard requirement, in which case the build will fail.
exclude-packages:
  - python
  - python2
  # - python3
  - perl
  - nodejs
  - dnf
  - grubby
  - cowsay  # Just in case
  # Let's make sure initscripts doesn't get pulled back in
  # https://github.com/coreos/fedora-coreos-tracker/issues/220#issuecomment-611566254
  - initscripts
  - PackageKit

arch-include:
  x86_64: manifests/grub2-removals.yaml
  aarch64: manifests/grub2-removals.yaml
  ppc64le: manifests/grub2-removals.yaml